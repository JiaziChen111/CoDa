---
title: "CoDa Vignette"
author: "Marius Pascariu"
date: "`r Sys.Date()`"
output: rmarkdown::pdf_document
  # rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

**CoDa** R package


This repository contains the source code for the CoDa model for forecasting mortality.

# Installation

1. Make sure you have installed the most recent version of R ( https://www.r-project.org )
2. Install the package in R using **devtools** by running the following code in your R console:

```{r, eval=FALSE, echo=TRUE}
if (!requireNamespace("devtools")) install.packages("devtools")
devtools::install_github("mpascariu/CoDa")
```

# Help
All functions are documented in the standard way, which means that 
once you load the package using ```library(CoDa)```
you can just type ```?CoDa``` to see the help file. 



# Fit CoDa model
```{r}
rm(list = ls())
library(CoDa)

model1 <- CoDa(CoDa.data, x = 0:110, y = 1960:2014)
model1
```

```{r, echo=FALSE}
plot(CoDa.data[, '2010'], xlab = 'Age (x)', ylab = 'dx', ylim = c(0, 0.04), pch = 16)
lines(model1$fitted[, '2010'], col = 2)
legend('topleft', pch = c(16, NA), lty = c(NA, 1), lwd = 3, col = c(1, 2), bty = 'n',
       legend = c('Observed values (2010)', 'Fitted values (2010)'))
```

## Output objects
```{r}
ls(model1)
```

## Summary
```{r}
summary(model1)
```

# Forecast

Predict life expectancy 30 years in the future using CoDa model:

```{r}
fc_model1 <- predict(model1, n = 30, jumpchoice = 'actual')
fc_model1
```


```{r, echo=FALSE}
plot(CoDa.data[, '2014'], xlab = 'Age (x)', ylab = 'dx', ylim = c(0, 0.045), pch = 16)
lines(fc_model1$predicted.values$mean[, '2044'], col = 3, lwd = 2)
legend('topleft', pch = c(16, NA), lty = c(NA, 1), lwd = 3, col = c(1, 3), bty = 'n',
       legend = c('Observed distribution in 2014', 'Forecast values in 2044'))
```




